@model Board // Replace Board with your actual Model type

@{
    ViewData["Title"] = "Board";
    Layout = "_ProjectLayout";
}

<style>
    /* General styles */
    .form-control-sm {
        height: auto;
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
        max-width: 200px; /* Adjust width as per your design */
    }

    .board {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 20px; /* Add margin between dropdown and board */
    }

    .column {
        flex: 1;
        background-color: #f0f0f0;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px; /* Adjust margin between columns */
    }

    .column-title {
        font-size: 1.1rem;
        margin-bottom: 10px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
    }

    .cards {
        margin-top: 10px;
    }

    .card {
        padding: 10px;
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: box-shadow 0.3s ease; /* Smooth transition for box-shadow */
        width: calc(100% - 20px); /* Make card fill the column width minus padding */
        margin-bottom: 10px; /* Adjust margin between cards */
    }

        .card:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Box-shadow effect on hover */
            cursor: pointer;
        }

    .card-title {
        font-size: 1rem;
        margin-top: 0;
    }

        .card-title a {
            color: inherit;
            text-decoration: none;
        }

            .card-title a:hover {
                text-decoration: underline; /* Underline on hover */
            }
</style>

<h2>Project Board</h2>

<form id="sprintForm">
    <div class="meta-section">
        <label asp-for="SelectedSprintId"></label>
        <select asp-for="SelectedSprintId"
                asp-items="@(new SelectList(Model.Sprints, "SprintId", "Name"))"
                class="form-control form-control-sm" id="sprintSelect">
            <option value="" disabled>Select a sprint</option>
        </select>
        <span asp-validation-for="SelectedSprintId" class="text-danger"></span>
    </div>
</form>

<div class="board">
    @foreach (var column in Model.Columns)
    {
        <div class="column">
            <h3 class="column-title">@column.Name</h3>
            <div class="cards">
                @foreach (var card in column.Cards)
                {
                    <a href="~/project/@Model.ProjectId/issue/@card.id/details" class="card-link">
                        <div class="card">
                           <h4 class="card-title">@card.Number. @card.Title</h4>
                        </div>
                    </a>
                }
            </div>
        </div>
    }
</div>

<script>
    $(document).ready(function () {
        var selectedSprintId = '@Model.SelectedSprintId';

        // Set the default selected option based on Model.SelectedSprintId
        if (selectedSprintId) {
            $("#sprintSelect").val(selectedSprintId);
        }

        // Event handler for dropdown change
        $("#sprintSelect").on("change", function () {
            var selectedSprintId = $(this).val();

            // Construct the URL dynamically with selected sprintId
            var url = `/project/@Model.ProjectId/board/${selectedSprintId}`;

            // Navigate to the constructed URL
            window.location.href = url;
        });
    });
</script>
